#!/bin/bash
cat << "EOF"
⠀⠀⠀⠀⠀⠀⠀⠀⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⣼⣿⡄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⣸⣿⣿⣷⣤⣴⣦⣀⣠⣶⡶⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⢠⣄⡀⠀⣼⣿⣿⣿⣿⡿⣿⣿⣿⣿⣿⣿⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠘⣿⣿⣿⣿⣿⣿⣿⡾⢛⠋⡛⠻⣿⣿⣿⣿⣧⣴⣶⠄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⢸⣿⣿⣿⣿⣽⡏⠰⡈⢆⢡⣷⢀⠻⣿⣿⣿⣿⣇⡀⢀⣀⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⢻⣿⣿⣿⣻⣿⠄⢣⠘⡄⢺⡏⢄⢣⡌⠻⣿⣿⣿⣿⣿⣿⣷⣶⣶⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⣿⣿⣷⣶⣦⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⣀⣸⣿⣿⣿⣿⣿⡏⢄⠣⢌⣹⠇⡌⣼⢇⠱⡈⠿⣿⣿⣿⡿⠿⠛⠛⠛⠛⠛⠛⠛⠿⢿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠹⢿⣿⣿⣿⣷⣿⣿⣦⠑⣂⡿⠰⡐⡿⢈⠆⡑⢢⢙⡿⢉⠐⡠⠑⣈⠂⠥⠘⡀⢃⠰⠀⡌⠙⠯⣉⢩⣿⣿⣿⣿⣿⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠈⠹⣿⣿⣿⣽⣿⣷⣜⠏⡰⢱⡟⡠⢊⠔⣡⡿⢁⠂⡡⠄⢡⠠⠌⢠⠁⠒⡈⠄⡡⢀⠃⠤⣹⣿⣿⣿⣿⣿⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠈⣻⣿⣿⣿⣿⣿⣷⣤⠹⢇⠰⡁⢎⣾⠁⠂⡔⠠⠘⡀⢂⠌⠄⠌⠡⡐⢈⡐⠄⢊⣼⣿⣿⣿⣿⣿⡃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠙⠛⠛⢻⣿⣿⣯⣿⣿⣷⣌⠢⠑⢬⡇⠌⠡⠠⠑⢂⢁⢢⡈⠌⡐⠡⠠⢁⡐⠈⢼⣿⣿⣿⣿⡿⢁⢻⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠈⣻⣿⣿⣿⣿⣿⣧⣍⢾⠃⠌⢂⡁⢎⣶⣿⣯⣭⡘⠰⡡⢁⠂⠤⢉⠈⠿⣿⣿⠟⢀⠂⠄⠛⣧⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⡿⡙⢹⣿⣿⣿⣿⣿⣿⠈⠔⠂⢤⣿⣿⣿⣿⣿⣅⠀⠹⠄⡘⢀⢂⠡⠂⢄⠠⢈⠄⠊⠌⡐⢉⣷⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⢰⡇⡇⣾⣿⣿⡿⣿⣿⣿⡈⠄⢃⠘⣿⣿⣿⣿⣿⣿⠀⢠⠃⠄⠃⠄⡂⢉⠄⢂⠡⢈⠌⡐⢈⠄⡘⣷⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⢸⡇⣓⡘⠿⣿⢷⠙⠛⣻⠡⢈⠄⢊⡘⢿⢿⠿⠟⠃⢠⠞⣨⠐⡉⡐⢈⠤⠈⡄⢂⡁⢂⠌⠄⡂⠔⠘⣷⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⣯⠱⢈⠐⠂⢾⣁⣂⣽⣆⠂⣌⣼⠇⠠⢉⠐⡀⠉⠤⢈⠳⠇⡐⠠⢁⠂⡡⠐⡠⠐⠂⠌⡐⠐⡨⠐⠸⣧⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠸⣇⠂⠌⣁⠂⡉⢹⣟⣿⣻⡯⠁⠌⢂⡁⠢⢈⢁⠒⠠⠒⡀⠆⣁⠂⠡⠄⡑⠠⠑⣈⠐⡈⠔⠠⠑⢂⢹⡆⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠙⣧⠌⣀⠒⡈⡐⠻⣮⡷⠃⠌⢂⠡⠠⠑⣀⠊⠄⡑⠠⢁⠂⠤⢈⠁⠆⡐⠡⠌⣀⠂⠡⠌⢂⠡⢂⠘⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⢳⣤⠒⠠⠐⠡⣀⠐⡈⠔⡈⠤⠑⡈⠄⠌⡐⢈⡁⢂⠡⠒⡈⠰⠈⢄⡁⠆⠠⠌⠡⣈⠐⡐⡈⠌⣻⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠙⢷⡈⠅⠒⡀⢂⠁⠆⠰⠀⡅⠂⠌⠒⡈⠄⠰⠈⢄⠡⠐⠡⠌⢠⠐⡈⢡⠈⠔⡀⠒⢠⠐⡈⣿⡃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣿⠠⢁⠂⢿⡆⠌⡁⢺⠇⡁⢊⠐⣄⠉⠄⠃⡄⠊⠌⡐⠌⡀⠆⡁⢂⠌⡐⠠⠉⠄⢂⠁⣾⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⠀⠀⠀⠘⣧⠒⡈⠄⢶⢀⠡⡞⡐⠠⢁⣞⠂⢌⠘⢠⠐⣡⡬⠴⢒⠃⡐⡈⠄⢂⠌⠡⠘⡈⠄⢊⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣾⠹⣧⠀⢀⣤⠾⢷⡐⡈⢼⡆⢸⡇⠡⢘⣼⢳⡿⣦⠈⣤⠿⢁⢂⠁⠆⡈⠔⠠⢁⠊⠄⡡⠡⢐⠈⣼⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⡇⢃⢹⡷⠋⢄⠂⠜⠹⢶⠾⢁⠚⢿⡴⠟⢡⣿⠓⠸⣿⠋⡐⠄⢂⠉⡐⡐⠨⠐⠡⡈⢄⡛⢁⠂⣸⡟⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⣸⢰⠀⡂⠿⠈⢄⡈⢂⡁⢂⠐⠂⡌⠠⠐⡈⠴⣿⢀⠡⠘⣆⠰⢈⠂⢡⠐⣀⠃⠡⢒⡼⠋⡐⠈⣴⡟⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⢿⡀⠆⡁⢂⠡⢂⠐⡠⠐⡈⠄⠃⡄⠡⢁⠂⢼⣿⠀⠂⡅⢂⡐⠂⠌⢤⣒⠠⠬⠓⡉⠄⢒⣠⡿⠛⢶⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠘⠷⠶⠶⢧⠶⡶⢶⠶⡷⢶⠾⡶⢶⠷⡶⠾⠼⢿⣠⣁⣐⣠⣀⣉⣒⣰⣂⣦⣥⣖⣴⠮⠿⠳⠶⠾⠴⠿⠿⠿⠳⠶⣦⣀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣤⣦⣶⣼⡟⠃⠀⠀⠀⠀⠀⠃⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠉⠛⠻⠿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀

  _____  _____ _____ _____ _   _  _____                 _                         
 |  __ \|_   _/ ____|_   _| \ | |/ ____|               | |                        
 | |__) | | || |      | | |  \| | |  __    __ _  ___   | |__  _ __ _ __ _ __ _ __ 
 |  _  /  | || |      | | | . ` | | |_ |  / _` |/ _ \  | '_ \| '__| '__| '__| '__|
 | | \ \ _| || |____ _| |_| |\  | |__| | | (_| | (_) | | |_) | |  | |  | |  | |   
 |_|  \_\_____\_____|_____|_| \_|\_____|  \__, |\___/  |_.__/|_|  |_|  |_|  |_|   
                                           __/ |                                  
                                          |___/                                                                                                            
EOF
if ! command -v gum &> /dev/null; then
    sudo mkdir -p /etc/apt/keyrings
    curl -fsSL https://repo.charm.sh/apt/gpg.key | sudo gpg --dearmor -o /etc/apt/keyrings/charm.gpg
    echo "deb [signed-by=/etc/apt/keyrings/charm.gpg] https://repo.charm.sh/apt/ * *" | sudo tee /etc/apt/sources.list.d/charm.list
    sudo apt update -y && sudo apt install -y gum
fi

echo "Auto or Personnalized"
auto=$(gum choose --cursor.foreground="#F00" --height 2 --limit 1 Auto Personnalized)

if [ "$auto" = "Personnalized" ]; then
IFS=$'\n' read -r -d '' -a choices < <(gum choose --cursor.foreground="#F00" --height 27 --limit 27 "HUNT (A simplified Find command made with Rust)" "PLOW (An HTTP(S) benchmarking tool)" "CATP (Print the output of a running process)" "CURL-IMPERSONATE (A special build of curl)" "NTFY (Send push notifications to your phone or desktop)" "K9S (Kubernetes CLI)" "NNN (A full-featured terminal file manager)" "NCDU (A disk utility for Unix systems)" "SSH-TOOLS (Making SSH more convenient)" "NALA (A front-end for libapt-pkg)" "NEOFETCH (A command-line system information tool)" "OTS (Share end-to-end encrypted secrets)" "VIDDY (A modern watch command)" "HTMLQ (Like jq, but for HTML)" "SYSZ (A terminal UI for systemctl)" "GPING (Ping, but with a graph)" "BAT (A cat clone with syntax highlighting)" "MILLER (Miller is like awk, sed, cut, join, and sort for data formats)" && printf '\0')
fi

# Function to install HUNT
install_hunt() {
    if ! command -v cargo &> /dev/null; then
        sudo gum spin --spinner moon --title.foreground="#239B56" --title "Installing : rust" -- bash -c "apt install -y rustc"
    fi
    if ! command -v hunt &> /dev/null; then
        cargo install hunt
    else 
        echo "Hunt is already installed." | gum style --foreground="#F5B041" --border-foreground="#F5B041" --border rounded --align center
    fi
}

# Function to install PLOW
install_plow() {
    if ! command -v plow &> /dev/null; then
        go install github.com/six-ddc/plow@latest
    else
        echo "plow is already installed." | gum style --foreground="#F5B041" --border-foreground="#F5B041" --border rounded --align center
    fi
}

# Function to install CATP
install_catp() {
    if ! command -v catp &> /dev/null; then
        wget https://github.com/rapiz1/catp/releases/download/v0.2.0/catp-x86_64-unknown-linux-gnu.zip -O /tmp/catp.zip
        sudo unzip -o /tmp/catp.zip -d /usr/local/bin/ && sudo chmod +x /usr/local/bin/catp && rm /tmp/catp.zip
    else
        echo "catp is already installed." | gum style --foreground="#F5B041" --border-foreground="#F5B041" --border rounded --align center
    fi
}

# Function to install CURL-IMPERSONATE
install_curl_impersonate() {
    if ! command -v curl_chrome100 &> /dev/null; then
        sudo apt install -y libnss3 ca-certificates wget
        sudo wget https://github.com/lwthiker/curl-impersonate/releases/download/v0.6.0-alpha.1/curl-impersonate-v0.6.0-alpha.1.aarch64-linux-gnu.tar.gz -O /usr/local/bin/curl-imp.tar.gz
        sudo tar -xvf /usr/local/bin/curl-imp.tar.gz -C /usr/local/bin && sudo chmod +x /usr/local/bin/curl* && sudo rm /usr/local/bin/curl-imp.tar.gz
    else 
        echo "Curl_impersonate is already installed." | gum style --foreground="#F5B041" --border-foreground="#F5B041" --border rounded --align center
    fi
}

# Function to install NTFY
install_ntfy() {
    if ! command -v ntfy &> /dev/null; then
        sudo mkdir -p /etc/apt/keyrings
        curl -fsSL https://archive.heckel.io/apt/pubkey.txt | sudo gpg --dearmor -o /etc/apt/keyrings/archive.heckel.io.gpg
        sudo apt install -y apt-transport-https
        sudo sh -c "echo 'deb [arch=amd64 signed-by=/etc/apt/keyrings/archive.heckel.io.gpg] https://archive.heckel.io/apt debian main' > /etc/apt/sources.list.d/archive.heckel.io.list"  
        sudo apt update -y
        sudo apt install -y ntfy
        sudo systemctl enable ntfy
        sudo systemctl start ntfy
    else
        echo "ntfysh-bin is already installed." | gum style --foreground="#F5B041" --border-foreground="#F5B041" --border rounded --align center
    fi
}

# Function to install K9S
install_k9s() {
    if ! command -v k9s &> /dev/null; then
        go install github.com/derailed/k9s@latest
    else
        echo "k9s is already installed." | gum style --foreground="#F5B041" --border-foreground="#F5B041" --border rounded --align center
    fi
}

# Function to install NEOFETCH
install_neofetch() {
    sudo gum spin --spinner moon --title.foreground="#239B56" --title "Installing : neofetch" -- bash -c "apt install -y neofetch"
}

# Function to install OTS
install_ots() {
    if ! command -v ots &> /dev/null; then
        go install github.com/sniptt-official/ots@latest
    else
        echo "ots is already installed." | gum style --foreground="#F5B041" --border-foreground="#F5B041" --border rounded --align center
    fi  
}

# Function to install BOTTOM
install_bottom() {
    curl -LO https://github.com/ClementTsang/bottom/releases/download/0.9.6/bottom_0.9.6_amd64.deb
    sudo dpkg -i bottom_0.9.6_amd64.deb
}

# Function to install VIDDY
install_viddy() {
    if ! command -v viddy &> /dev/null; then
        go install github.com/sachaos/viddy@latest
    else
        echo "viddy is already installed." | gum style --foreground="#F5B041" --border-foreground="#F5B041" --border rounded --align center
    fi  
}

# Function to install HTMLQ
install_htmlq() {
    if ! command -v cargo &> /dev/null; then
        sudo gum spin --spinner moon --title.foreground="#239B56" --title "Installing : rust" -- bash -c "apt install -y rustc"
    fi
    if ! command -v htmlq &> /dev/null; then
        cargo install htmlq
    else 
        echo "htmlq is already installed." | gum style --foreground="#F5B041" --border-foreground="#F5B041" --border rounded --align center
    fi
}

# Function to install SYSZ
install_sysz() {
    if ! command -v sysz &> /dev/null; then
        sudo wget -O /usr/local/bin/sysz https://github.com/joehillen/sysz/releases/latest/download/sysz
        sudo chmod +x /usr/local/bin/sysz
    else
        echo "sysz is already installed." | gum style --foreground="#F5B041" --border-foreground="#F5B041" --border rounded --align center
    fi
}

# Function to install MILLER
install_miller() {
    sudo gum spin --spinner moon --title.foreground="#239B56" --title "Installing : pueue" -- bash -c "apt-get install -y miller"
}

# Function to install GPING
install_gping() {
    echo "deb [signed-by=/usr/share/keyrings/azlux-archive-keyring.gpg] http://packages.azlux.fr/debian/ stable main" | sudo tee /etc/apt/sources.list.d/azlux.list
    sudo wget -O /usr/share/keyrings/azlux-archive-keyring.gpg  https://azlux.fr/repo.gpg
    sudo apt update -y
    sudo gum spin --spinner moon --title.foreground="#239B56" --title "Installing : gping" -- bash -c "apt install -y gping"
}

# Function to install BAT
install_bat() {
    sudo gum spin --spinner moon --title.foreground="#239B56" --title "Installing : bat" -- bash -c "apt install -y bat"
}

# Function to install SSH-TOOLS
install_ssh_tools(){
    sudo gum spin --spinner moon --title.foreground="#239B56" --title "Installing : ssh-tools" -- bash -c "apt install -y ssh-tools"
}

# Function to install NCDU
install_ncdu(){
    sudo gum spin --spinner moon --title.foreground="#239B56" --title "Installing : ncdu" -- bash -c "apt install -y ncdu"
}

# Function to install NNN
install_nnn(){
    sudo gum spin --spinner moon --title.foreground="#239B56" --title "Installing : nnn" -- bash -c "apt install -y nnn"
}

# Function to install NALA
install_nala(){
    sudo gum spin --spinner moon --title.foreground="#239B56" --title "Installing : nala" -- bash -c "apt install -y nala"
}
################################################

gum style --foreground="#239B56" --border-foreground="#239B56" --border double --align center --padding "1 1" "Base Package"
for pkg in zsh fasd peco acpi go; do
    if ! command -v $pkg &> /dev/null; then
        (sudo gum spin --spinner moon --title.foreground="#239B56" --title "Installing : $pkg" -- bash -c "apt install -y $pkg")
    else
        echo "$pkg is already installed." | gum style --foreground="#F5B041" --border-foreground="#F5B041" --border rounded --align center
    fi
done

if [ ! -d "$HOME/.oh-my-zsh" ]; then
    curl -fsSL https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh -o install_oh_my_zsh.sh
    sed -i 's/exec zsh -l//g' install_oh_my_zsh.sh
    sh install_oh_my_zsh.sh
else
    echo "Oh My Zsh is already installed." | gum style --foreground="#F5B041" --border-foreground="#F5B041" --border rounded --align center
fi

ZSH_CUSTOM=${ZSH_CUSTOM:-$HOME/.oh-my-zsh/custom}

themes_and_plugins=(
    "spaceship-prompt https://github.com/spaceship-prompt/spaceship-prompt.git"
    "zsh-peco-history https://github.com/jimeh/zsh-peco-history.git"
    "zsh-autosuggestions https://github.com/zsh-users/zsh-autosuggestions"
    "zsh-syntax-highlighting https://github.com/zsh-users/zsh-syntax-highlighting"
    "you-should-use https://github.com/MichaelAquilina/zsh-you-should-use.git"
)

for item in "${themes_and_plugins[@]}"; do
    read -ra ADDR <<< "$item"
    if [ ! -d "$ZSH_CUSTOM/${ADDR[0]}" ]; then
        git clone "${ADDR[1]}" "$ZSH_CUSTOM/${ADDR[0]}" --depth=1
    else
        echo "${ADDR[0]} is already cloned." | gum style --foreground="#F5B041" --border-foreground="#F5B041" --border rounded --align center
    fi
done

if [ ! -f "$ZSH_CUSTOM/themes/spaceship.zsh-theme" ]; then
    ln -s "$ZSH_CUSTOM/themes/spaceship-prompt/spaceship.zsh-theme" "$ZSH_CUSTOM/themes/spaceship.zsh-theme"
fi

sed -i '/^ZSH_THEME=/c\ZSH_THEME="spaceship"' ~/.zshrc
sed -i '/^plugins=(/c\plugins=(git fasd zsh-peco-history zsh-autosuggestions zsh-syntax-highlighting you-should-use docker archlinux ansible aws azure battery colored-man-pages colorize command-not-found docker-compose rsync rust terraform zsh-interactive-cd)' ~/.zshrc

if ! grep -q 'export PATH="$HOME/.cargo/bin:$PATH"' ~/.zshrc; then
    echo 'export PATH="$HOME/.cargo/bin:$PATH"' >> ~/.zshrc
fi
if ! grep -q 'export PATH="$PATH:$(go env GOBIN):$(go env GOPATH)/bin"' ~/.zshrc; then
    echo 'export PATH="$PATH:$(go env GOBIN):$(go env GOPATH)/bin"' >> ~/.zshrc
fi
if ! grep -q "alias cdi='cd \$(ls | peco)'" ~/.zshrc; then
    echo "alias cdi='cd \$(ls | peco)'" >> ~/.zshrc
fi
if ! grep -q "alias -g xcopy='xclip -selection clipboard'" ~/.zshrc; then
    echo "alias -g xcopy='xclip -selection clipboard'" >> ~/.zshrc
fi
if ! grep -q "alias -g xpaste='xclip -selection clipboard -o'" ~/.zshrc; then
    echo "alias -g xpaste='xclip -selection clipboard -o'" >> ~/.zshrc
fi


mkdir -p ~/.config && touch ~/.config/spaceship.zsh
cat << "EOF" > ~/.config/spaceship.zsh
SPACESHIP_PROMPT_ORDER=(
  time          # Time stamps section
  user          # Username section
  dir           # Current directory section
  host          # Hostname section
  git           # Git section (git_branch + git_status)
  python
  hg            # Mercurial section (hg_branch  + hg_status)
  exec_time     # Execution time
  line_sep      # Line break
  battery       # Battery level and status
  jobs          # Background jobs indicator
  exit_code     # Exit code section
  sudo          # Sudo indicator
  char          # Prompt character
)

SPACESHIP_TIME_SHOW=true
SPACESHIP_USER_SHOW=always
SPACESHIP_PROMPT_ADD_NEWLINE=false
SPACESHIP_CHAR_SYMBOL="❯"
SPACESHIP_CHAR_SUFFIX=" "
SPACESHIP_DIR_COLOR=red
SPACESHIP_USER_COLOR=red
SPACESHIP_TIME_FORMAT='%D{%H:%M}'
SPACESHIP_TIME_COLOR=red
EOF

####################################

gum style --foreground="#239B56" --border-foreground="#239B56" --border double --align center --padding "1 1" "Extended Tools"
if [ "$auto" = "Auto" ]; then
    declare -A custom_installs=(
        ["hunt"]="install_hunt"
        ["plow"]="install_plow"
        ["catp"]="install_catp"
        ["curl_impersonate"]="install_curl_impersonate"
        ["ntfy"]="install_ntfy"
        ["k9s"]="install_k9s"
        ["nnn"]="install_nnn"
        ["ncdu"]="install_ncdu"
        ["ssh-tools"]="install_ssh_tools"
        ["nala"]="install_nala"
        ["neofetch"]="install_neofetch"
        ["ots"]="install_ots"
        ["viddy"]="install_viddy"
        ["htmlq"]="install_htmlq"
        ["sysz"]="install_sysz"
        ["gping"]="install_gping"
        ["bat"]="install_bat"
        ["miller"]="install_miller"
    )
    for key in "${!custom_installs[@]}"; do
        if declare -f "${custom_installs[$key]}" > /dev/null; then
            "${custom_installs[$key]}"
        else
            echo "Not find ${custom_installs[$key]} install option $key" | gum style --foreground="#C0392B" --border-foreground="#C0392B" --border rounded --align center
        fi
    done
else
    for choice in "${choices[@]}"; do
        case "$choice" in
            "HUNT (A simplified Find command made with Rust)") install_hunt ;;
            "PLOW (An HTTP(S) benchmarking tool)") install_plow ;;
            "CATP (Print the output of a running process)") install_catp ;;
            "CURL-IMPERSONATE (A special build of curl)") install_curl_impersonate ;;
            "NTFY (Send push notifications to your phone or desktop)") install_ntfy ;;
            "K9S (Kubernetes CLI)") install_k9s ;;
            "NNN (A full-featured terminal file manager)") install_nnn ;;
            "NCDU (A disk utility for Unix systems)") install_ncdu ;;
            "SSH-TOOLS (Making SSH more convenient)") install_ssh_tools ;;
            "NALA (A front-end for libapt-pkg)") install_nala ;;
            "NEOFETCH (A command-line system information tool)") install_neofetch ;;
            "OTS (Share end-to-end encrypted secrets)") install_ots ;;
            "VIDDY (A modern watch command)") install_viddy ;;
            "HTMLQ (Like jq, but for HTML)") install_htmlq ;;
            "SYSZ (A terminal UI for systemctl)") install_sysz ;;
            "GPING (Ping, but with a graph)") install_gping ;;
            "BAT (A cat clone with syntax highlighting)") install_bat ;;
            "MILLER (Miller is like awk, sed, cut, join, and sort for data formats)") install_miller ;;
            *) echo "Invalid choice: $choice" | gum style --foreground="#C0392B" --border-foreground="#C0392B" --border rounded --align center ;;
        esac
    done
fi

gum style --foreground="#239B56" --border-foreground="#239B56" --border double --align center --padding "1 2" "Installation complete."

if [ "$(getent passwd $USER | cut -d: -f7)" != "/bin/zsh" ]; then
    chsh -s /bin/zsh
fi
exec zsh -l