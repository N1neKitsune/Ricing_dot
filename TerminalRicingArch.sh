#!/bin/bash
cat << "EOF"
⠀⠀⠀⠀⠀⠀⠀⠀⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⣼⣿⡄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⣸⣿⣿⣷⣤⣴⣦⣀⣠⣶⡶⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⢠⣄⡀⠀⣼⣿⣿⣿⣿⡿⣿⣿⣿⣿⣿⣿⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠘⣿⣿⣿⣿⣿⣿⣿⡾⢛⠋⡛⠻⣿⣿⣿⣿⣧⣴⣶⠄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⢸⣿⣿⣿⣿⣽⡏⠰⡈⢆⢡⣷⢀⠻⣿⣿⣿⣿⣇⡀⢀⣀⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⢻⣿⣿⣿⣻⣿⠄⢣⠘⡄⢺⡏⢄⢣⡌⠻⣿⣿⣿⣿⣿⣿⣷⣶⣶⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⣿⣿⣷⣶⣦⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⣀⣸⣿⣿⣿⣿⣿⡏⢄⠣⢌⣹⠇⡌⣼⢇⠱⡈⠿⣿⣿⣿⡿⠿⠛⠛⠛⠛⠛⠛⠛⠿⢿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠹⢿⣿⣿⣿⣷⣿⣿⣦⠑⣂⡿⠰⡐⡿⢈⠆⡑⢢⢙⡿⢉⠐⡠⠑⣈⠂⠥⠘⡀⢃⠰⠀⡌⠙⠯⣉⢩⣿⣿⣿⣿⣿⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠈⠹⣿⣿⣿⣽⣿⣷⣜⠏⡰⢱⡟⡠⢊⠔⣡⡿⢁⠂⡡⠄⢡⠠⠌⢠⠁⠒⡈⠄⡡⢀⠃⠤⣹⣿⣿⣿⣿⣿⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠈⣻⣿⣿⣿⣿⣿⣷⣤⠹⢇⠰⡁⢎⣾⠁⠂⡔⠠⠘⡀⢂⠌⠄⠌⠡⡐⢈⡐⠄⢊⣼⣿⣿⣿⣿⣿⡃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠙⠛⠛⢻⣿⣿⣯⣿⣿⣷⣌⠢⠑⢬⡇⠌⠡⠠⠑⢂⢁⢢⡈⠌⡐⠡⠠⢁⡐⠈⢼⣿⣿⣿⣿⡿⢁⢻⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠈⣻⣿⣿⣿⣿⣿⣧⣍⢾⠃⠌⢂⡁⢎⣶⣿⣯⣭⡘⠰⡡⢁⠂⠤⢉⠈⠿⣿⣿⠟⢀⠂⠄⠛⣧⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⡿⡙⢹⣿⣿⣿⣿⣿⣿⠈⠔⠂⢤⣿⣿⣿⣿⣿⣅⠀⠹⠄⡘⢀⢂⠡⠂⢄⠠⢈⠄⠊⠌⡐⢉⣷⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⢰⡇⡇⣾⣿⣿⡿⣿⣿⣿⡈⠄⢃⠘⣿⣿⣿⣿⣿⣿⠀⢠⠃⠄⠃⠄⡂⢉⠄⢂⠡⢈⠌⡐⢈⠄⡘⣷⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⢸⡇⣓⡘⠿⣿⢷⠙⠛⣻⠡⢈⠄⢊⡘⢿⢿⠿⠟⠃⢠⠞⣨⠐⡉⡐⢈⠤⠈⡄⢂⡁⢂⠌⠄⡂⠔⠘⣷⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⣯⠱⢈⠐⠂⢾⣁⣂⣽⣆⠂⣌⣼⠇⠠⢉⠐⡀⠉⠤⢈⠳⠇⡐⠠⢁⠂⡡⠐⡠⠐⠂⠌⡐⠐⡨⠐⠸⣧⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠸⣇⠂⠌⣁⠂⡉⢹⣟⣿⣻⡯⠁⠌⢂⡁⠢⢈⢁⠒⠠⠒⡀⠆⣁⠂⠡⠄⡑⠠⠑⣈⠐⡈⠔⠠⠑⢂⢹⡆⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠙⣧⠌⣀⠒⡈⡐⠻⣮⡷⠃⠌⢂⠡⠠⠑⣀⠊⠄⡑⠠⢁⠂⠤⢈⠁⠆⡐⠡⠌⣀⠂⠡⠌⢂⠡⢂⠘⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⢳⣤⠒⠠⠐⠡⣀⠐⡈⠔⡈⠤⠑⡈⠄⠌⡐⢈⡁⢂⠡⠒⡈⠰⠈⢄⡁⠆⠠⠌⠡⣈⠐⡐⡈⠌⣻⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠙⢷⡈⠅⠒⡀⢂⠁⠆⠰⠀⡅⠂⠌⠒⡈⠄⠰⠈⢄⠡⠐⠡⠌⢠⠐⡈⢡⠈⠔⡀⠒⢠⠐⡈⣿⡃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣿⠠⢁⠂⢿⡆⠌⡁⢺⠇⡁⢊⠐⣄⠉⠄⠃⡄⠊⠌⡐⠌⡀⠆⡁⢂⠌⡐⠠⠉⠄⢂⠁⣾⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⠀⠀⠀⠘⣧⠒⡈⠄⢶⢀⠡⡞⡐⠠⢁⣞⠂⢌⠘⢠⠐⣡⡬⠴⢒⠃⡐⡈⠄⢂⠌⠡⠘⡈⠄⢊⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣾⠹⣧⠀⢀⣤⠾⢷⡐⡈⢼⡆⢸⡇⠡⢘⣼⢳⡿⣦⠈⣤⠿⢁⢂⠁⠆⡈⠔⠠⢁⠊⠄⡡⠡⢐⠈⣼⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⡇⢃⢹⡷⠋⢄⠂⠜⠹⢶⠾⢁⠚⢿⡴⠟⢡⣿⠓⠸⣿⠋⡐⠄⢂⠉⡐⡐⠨⠐⠡⡈⢄⡛⢁⠂⣸⡟⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⣸⢰⠀⡂⠿⠈⢄⡈⢂⡁⢂⠐⠂⡌⠠⠐⡈⠴⣿⢀⠡⠘⣆⠰⢈⠂⢡⠐⣀⠃⠡⢒⡼⠋⡐⠈⣴⡟⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⢿⡀⠆⡁⢂⠡⢂⠐⡠⠐⡈⠄⠃⡄⠡⢁⠂⢼⣿⠀⠂⡅⢂⡐⠂⠌⢤⣒⠠⠬⠓⡉⠄⢒⣠⡿⠛⢶⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠘⠷⠶⠶⢧⠶⡶⢶⠶⡷⢶⠾⡶⢶⠷⡶⠾⠼⢿⣠⣁⣐⣠⣀⣉⣒⣰⣂⣦⣥⣖⣴⠮⠿⠳⠶⠾⠴⠿⠿⠿⠳⠶⣦⣀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣤⣦⣶⣼⡟⠃⠀⠀⠀⠀⠀⠃⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠉⠛⠻⠿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀

  _____  _____ _____ _____ _   _  _____                 _                         
 |  __ \|_   _/ ____|_   _| \ | |/ ____|               | |                        
 | |__) | | || |      | | |  \| | |  __    __ _  ___   | |__  _ __ _ __ _ __ _ __ 
 |  _  /  | || |      | | | . ` | | |_ |  / _` |/ _ \  | '_ \| '__| '__| '__| '__|
 | | \ \ _| || |____ _| |_| |\  | |__| | | (_| | (_) | | |_) | |  | |  | |  | |   
 |_|  \_\_____\_____|_____|_| \_|\_____|  \__, |\___/  |_.__/|_|  |_|  |_|  |_|   
                                           __/ |                                  
                                          |___/                                                                                                            
EOF
if ! pacman -Qi gum &> /dev/null; then
    pacman -S --needed --noconfirm gum > /dev/null
fi

echo "Auto or Personnalized"
auto=$(gum choose --cursor.foreground="#F00" --height 2 --limit 1 Auto Personnalized)

if [ "$auto" = "Personnalized" ]; then
IFS=$'\n' read -r -d '' -a choices < <(gum choose --cursor.foreground="#F00" --height 26 --limit 26 "YAY (Yet Another Yogurt - An AUR Helper)" "HUNT (A simplified Find command made with Rust)" "DOOIT (A todo manager)" "PLOW (An HTTP(S) benchmarking tool)" "CATP (Print the output of a running process)" "CURL-IMPERSONATE (A special build of curl)" "NTFY (Send push notifications to your phone or desktop)" "JQP (A TUI playground for exploring jq)" "K9S (Kubernetes CLI)" "NNN (A full-featured terminal file manager)" "NCDU (A disk utility for Unix systems)" "SSH-TOOLS (Making SSH more convenient)" "NALA (A front-end for libapt-pkg)" "NEOFETCH (A command-line system information tool)" "OTS (Share end-to-end encrypted secrets)" "BOTTOM (A graphical process/system monitor)" "VIDDY (A modern watch command)" "HTMLQ (Like jq, but for HTML)" "SYSZ (A terminal UI for systemctl)" "MILLER (Like awk, sed, cut, join, and sort for data formats)" "PUEUE (A command-line task management tool)" "VIZEX (Visualize disk space usage)" "GPING (Ping, but with a graph)" "TEMPMAIL (A temporary email right from your terminal)" "BAT (A cat clone with syntax highlighting)" "NAVI (An interactive cheatsheet tool)" && printf '\0')
fi

# Function to install YAY
install_yay() {
    if ! command -v yay &> /dev/null; then
        sudo gum spin --spinner moon --title.foreground="#239B56" --title "Installing : git base-devel" -- bash -c "pacman -S --needed --noconfirm git base-devel"
        git clone https://aur.archlinux.org/yay.git
        cd yay && makepkg -si && cd .. && rm -rf yay
    else
        echo "YAY is already installed." | gum style --foreground="#F5B041" --border-foreground="#F5B041" --border rounded --align center
    fi
}

# Function to install HUNT
install_hunt() {
    if ! command -v cargo &> /dev/null; then
        sudo gum spin --spinner moon --title.foreground="#239B56" --title "Installing : rust" -- bash -c "pacman -S --needed --noconfirm rust"
    fi
    if ! command -V hunt &> /dev/null; then
        cargo install hunt
    else 
        echo "Hunt is already installed." | gum style --foreground="#F5B041" --border-foreground="#F5B041" --border rounded --align center
    fi
}

# Function to install DOOIT
install_dooit() {
    install_yay
    if ! pacman -Qi dooit-git &> /dev/null; then
        yay -S --noconfirm dooit-git
    else
        echo "dooit-git is already installed." | gum style --foreground="#F5B041" --border-foreground="#F5B041" --border rounded --align center
    fi
}

# Function to install PLOW
install_plow() {
    install_yay
    if ! pacman -Qi plow &> /dev/null; then
        yay -S --noconfirm plow
    else
        echo "plow is already installed." | gum style --foreground="#F5B041" --border-foreground="#F5B041" --border rounded --align center
    fi
}

# Function to install CATP
install_catp() {
    if ! command -v catp &> /dev/null; then
        wget https://github.com/rapiz1/catp/releases/download/v0.2.0/catp-x86_64-unknown-linux-gnu.zip -O /tmp/catp.zip
        sudo unzip -o /tmp/catp.zip -d /usr/local/bin/ && sudo chmod +x /usr/local/bin/catp && rm /tmp/catp.zip
    else
        echo "catp is already installed." | gum style --foreground="#F5B041" --border-foreground="#F5B041" --border rounded --align center
    fi
}

# Function to install CURL-IMPERSONATE
install_curl_impersonate() {
    if ! command -v curl_chrome100 &> /dev/null; then
        sudo pacman -S --needed --noconfirm  nss ca-certificates wget
        sudo wget https://github.com/lwthiker/curl-impersonate/releases/download/v0.6.0-alpha.1/curl-impersonate-v0.6.0-alpha.1.aarch64-linux-gnu.tar.gz -O /usr/local/bin/curl-imp.tar.gz
        sudo tar -xvf /usr/local/bin/curl-imp.tar.gz -C /usr/local/bin && sudo chmod +x /usr/local/bin/curl* && sudo rm /usr/local/bin/curl-imp.tar.gz
    else 
        echo "Curl_impersonate is already installed." | gum style --foreground="#F5B041" --border-foreground="#F5B041" --border rounded --align center
    fi
}

# Function to install NTFY
install_ntfy() {
    install_yay
    if ! pacman -Qi ntfysh-bin &> /dev/null; then
        yay -S --noconfirm ntfysh-bin
    else
        echo "ntfysh-bin is already installed." | gum style --foreground="#F5B041" --border-foreground="#F5B041" --border rounded --align center
    fi
}

# Function to install JQP
install_jqp() {
    install_yay
    if ! pacman -Qi jqp-bin &> /dev/null; then
        yay -S --noconfirm jqp-bin
    else
        echo "jqp-bin is already installed." | gum style --foreground="#F5B041" --border-foreground="#F5B041" --border rounded --align center
    fi    
}

# Function to install K9S
install_k9s() {
    sudo gum spin --spinner moon --title.foreground="#239B56" --title "Installing : k9s" -- bash -c "pacman -S --needed --noconfirm k9s"
}

# Function to install NEOFETCH
install_neofetch() {
    sudo gum spin --spinner moon --title.foreground="#239B56" --title "Installing : neofetch" -- bash -c "pacman -S --needed --noconfirm neofetch"
}

# Function to install OTS
install_ots() {
    if ! command -v go &> /dev/null; then
        sudo gum spin --spinner moon --title.foreground="#239B56" --title "Installing : go" -- bash -c "pacman -S --needed --noconfirm go"
    fi
    sudo go install github.com/sniptt-official/ots@latest
}

# Function to install BOTTOM
install_bottom() {
    sudo gum spin --spinner moon --title.foreground="#239B56" --title "Installing : bottom" -- bash -c "pacman -S --needed --noconfirm bottom"
}

# Function to install VIDDY
install_viddy() {
    install_yay
    if ! pacman -Qi viddy &> /dev/null; then
        yay -S --noconfirm viddy
    else
        echo "viddy is already installed." | gum style --foreground="#F5B041" --border-foreground="#F5B041" --border rounded --align center
    fi  
}

# Function to install HTMLQ
install_htmlq() {
    if ! command -v cargo &> /dev/null; then
        sudo gum spin --spinner moon --title.foreground="#239B56" --title "Installing : rust" -- bash -c "pacman -S --needed --noconfirm rust"
    fi
    cargo install htmlq
}

# Function to install SYSZ
install_sysz() {
    install_yay
    if ! pacman -Qi sysz &> /dev/null; then
        yay -S --noconfirm sysz
    else
        echo "sysz is already installed." | gum style --foreground="#F5B041" --border-foreground="#F5B041" --border rounded --align center
    fi
}

# Function to install PUEUE
install_pueue() {
    sudo gum spin --spinner moon --title.foreground="#239B56" --title "Installing : pueue" -- bash -c "pacman -S --needed --noconfirm pueue"
}

# Function to install VIZEX
install_vizex() {
    install_yay
    if ! pacman -Qi vizex &> /dev/null; then
        yay -S --noconfirm vizex
    else
        echo "vizex is already installed." | gum style --foreground="#F5B041" --border-foreground="#F5B041" --border rounded --align center
    fi
}

# Function to install GPING
install_gping() {
    sudo gum spin --spinner moon --title.foreground="#239B56" --title "Installing : gping" -- bash -c "pacman -S --needed --noconfirm gping"
}

# Function to install TEMPMAIL
install_tempmail() {
    install_yay
    if ! pacman -Qi tmpmail-git &> /dev/null; then
        yay -S --noconfirm tmpmail-git
    else
        echo "tmpmail-git is already installed." | gum style --foreground="#F5B041" --border-foreground="#F5B041" --border rounded --align center
    fi
}

# Function to install BAT
install_bat() {
    sudo gum spin --spinner moon --title.foreground="#239B56" --title "Installing : bat" -- bash -c "pacman -S --needed --noconfirm bat"
}

# Function to install NAVI
install_navi() {
    sudo gum spin --spinner moon --title.foreground="#239B56" --title "Installing : navi" -- bash -c "pacman -S --needed --noconfirm navi"
}

# Function to install SSH-TOOLS
install_ssh_tools(){
    sudo gum spin --spinner moon --title.foreground="#239B56" --title "Installing : ssh-tools" -- bash -c "pacman -S --needed --noconfirm ssh-tools"
}

# Function to install NCDU
install_ncdu(){
    sudo gum spin --spinner moon --title.foreground="#239B56" --title "Installing : ncdu" -- bash -c "pacman -S --needed --noconfirm ncdu"
}

# Function to install NNN
install_nnn(){
    sudo gum spin --spinner moon --title.foreground="#239B56" --title "Installing : nnn" -- bash -c "pacman -S --needed --noconfirm nnn"
}
################################################

gum style --foreground="#239B56" --border-foreground="#239B56" --border double --align center --padding "1 1" "Base Package"
for pkg in zsh fasd peco acpi gum; do
    if ! pacman -Qi $pkg &> /dev/null; then
        (sudo gum spin --spinner moon --title.foreground="#239B56" --title "Installing : $pkg" -- bash -c "pacman -S --needed --noconfirm $pkg")
    else
        echo "$pkg is already installed." | gum style --foreground="#F5B041" --border-foreground="#F5B041" --border rounded --align center
    fi
done

if [ ! -d "$HOME/.oh-my-zsh" ]; then
    curl -fsSL https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh -o install_oh_my_zsh.sh
    sed -i 's/exec zsh -l//g' install_oh_my_zsh.sh
    sh install_oh_my_zsh.sh
else
    echo "Oh My Zsh is already installed." | gum style --foreground="#F5B041" --border-foreground="#F5B041" --border rounded --align center
fi

ZSH_CUSTOM=${ZSH_CUSTOM:-$HOME/.oh-my-zsh/custom}

themes_and_plugins=(
    "spaceship-prompt https://github.com/spaceship-prompt/spaceship-prompt.git"
    "zsh-peco-history https://github.com/jimeh/zsh-peco-history.git"
    "zsh-autosuggestions https://github.com/zsh-users/zsh-autosuggestions"
    "zsh-syntax-highlighting https://github.com/zsh-users/zsh-syntax-highlighting"
    "you-should-use https://github.com/MichaelAquilina/zsh-you-should-use.git"
)

for item in "${themes_and_plugins[@]}"; do
    read -ra ADDR <<< "$item"A
    if [ ! -d "$ZSH_CUSTOM/${ADDR[0]}" ]; then
        git clone "${ADDR[1]}" "$ZSH_CUSTOM/${ADDR[0]}" --depth=1
    else
        echo "${ADDR[0]} is already cloned." | gum style --foreground="#F5B041" --border-foreground="#F5B041" --border rounded --align center
    fi
done

if [ ! -f "$ZSH_CUSTOM/themes/spaceship.zsh-theme" ]; then
    ln -s "$ZSH_CUSTOM/themes/spaceship-prompt/spaceship.zsh-theme" "$ZSH_CUSTOM/themes/spaceship.zsh-theme"
fi

sed -i '/^ZSH_THEME=/c\ZSH_THEME="spaceship"' ~/.zshrc
sed -i '/^plugins=(/c\plugins=(git fasd zsh-peco-history zsh-autosuggestions zsh-syntax-highlighting you-should-use docker archlinux ansible aws azure battery colored-man-pages colorize command-not-found docker-compose rsync rust terraform zsh-interactive-cd)' ~/.zshrc

if ! grep -q 'export PATH="$HOME/.cargo/bin:$PATH"' ~/.zshrc; then
    echo 'export PATH="$HOME/.cargo/bin:$PATH"' >> ~/.zshrc
fi
if ! grep -q 'export PATH="$PATH:$(go env GOBIN):$(go env GOPATH)/bin"' ~/.zshrc; then
    echo 'export PATH="$PATH:$(go env GOBIN):$(go env GOPATH)/bin"' >> ~/.zshrc
fi
if ! grep -q "alias cdi='cd \$(ls | peco)'" ~/.zshrc; then
    echo "alias cdi='cd \$(ls | peco)'" >> ~/.zshrc
fi
if ! grep -q "alias -g xcopy='xclip -selection clipboard'" ~/.zshrc; then
    echo "alias -g xcopy='xclip -selection clipboard'" >> ~/.zshrc
fi
if ! grep -q "alias -g xpaste='xclip -selection clipboard -o'" ~/.zshrc; then
    echo "alias -g xpaste='xclip -selection clipboard -o'" >> ~/.zshrc
fi


mkdir -p ~/.config && touch ~/.config/spaceship.zsh
cat << "EOF" > ~/.config/spaceship.zsh
SPACESHIP_PROMPT_ORDER=(
  time          # Time stamps section
  user          # Username section
  dir           # Current directory section
  host          # Hostname section
  git           # Git section (git_branch + git_status)
  python
  hg            # Mercurial section (hg_branch  + hg_status)
  exec_time     # Execution time
  line_sep      # Line break
  battery       # Battery level and status
  jobs          # Background jobs indicator
  exit_code     # Exit code section
  sudo          # Sudo indicator
  char          # Prompt character
)

SPACESHIP_TIME_SHOW=true
SPACESHIP_USER_SHOW=always
SPACESHIP_PROMPT_ADD_NEWLINE=false
SPACESHIP_CHAR_SYMBOL="❯"
SPACESHIP_CHAR_SUFFIX=" "
SPACESHIP_DIR_COLOR=red
SPACESHIP_USER_COLOR=red
SPACESHIP_TIME_FORMAT='%D{%H:%M}'
SPACESHIP_TIME_COLOR=red
EOF

####################################

gum style --foreground="#239B56" --border-foreground="#239B56" --border double --align center --padding "1 1" "Extended Tools"
if [ "$auto" = "Auto" ]; then
    pacman_packages=(bottom nnn ncdu ssh-tools pueue gping bat navi rust k9s neofetch go)
    for pkg in "${pacman_packages[@]}"; do
        if ! pacman -Qi $pkg &> /dev/null; then
            (sudo gum spin --spinner moon --title.foreground="#239B56" --title "Installing : $pkg" -- bash -c "pacman -S --needed --noconfirm $pkg")
        else
            echo "$pkg est déjà installé." | gum style --foreground="#F5B041" --border-foreground="#F5B041" --border rounded --align center
        fi
    done
    declare -A custom_installs=(
        ["yay"]="install_yay"
        ["hunt"]="install_hunt"
        ["dooit"]="install_dooit"
        ["plow"]="install_plow"
        ["catp"]="install_catp"
        ["curl_impersonate"]="install_curl_impersonate"
        ["ntfy"]="install_ntfy"
        ["jqp"]="install_jqp"
        ["ots"]="install_ots"
        ["viddy"]="install_viddy"
        ["htmlq"]="install_htmlq"
        ["sysz"]="install_sysz"
        ["vizex"]="install_vizex"
        ["tempmail"]="install_tempmail"
    )
    for key in "${!custom_installs[@]}"; do
        if declare -f "${custom_installs[$key]}" > /dev/null; then
            "${custom_installs[$key]}"
        else
            echo "La fonction ${custom_installs[$key]} n'existe pas pour l'installation de $key." | gum style --foreground="#C0392B" --border-foreground="#C0392B" --border rounded --align center
        fi
    done
else
    for choice in "${choices[@]}"; do
        case "$choice" in
            "YAY (Yet Another Yogurt - An AUR Helper)") install_yay ;;
            "HUNT (A simplified Find command made with Rust)") install_hunt ;;
            "DOOIT (A todo manager)") install_dooit ;;
            "PLOW (An HTTP(S) benchmarking tool)") install_plow ;;
            "CATP (Print the output of a running process)") install_catp ;;
            "CURL-IMPERSONATE (A special build of curl)") install_curl_impersonate ;;
            "NTFY (Send push notifications to your phone or desktop)") install_ntfy ;;
            "JQP (A TUI playground for exploring jq)") install_jqp ;;
            "K9S (Kubernetes CLI)") install_k9s ;;
            "NNN (A full-featured terminal file manager)") install_nnn ;;
            "NCDU (A disk utility for Unix systems)") install_ncdu ;;
            "SSH-TOOLS (Making SSH more convenient)") install_ssh_tools ;;
            "NALA (A front-end for libapt-pkg)") echo "Nala is only for APT (Debian/Ubuntu systems)." ;;
            "NEOFETCH (A command-line system information tool)") install_neofetch ;;
            "OTS (Share end-to-end encrypted secrets)") install_ots ;;
            "BOTTOM (A graphical process/system monitor)") install_bottom ;;
            "VIDDY (A modern watch command)") install_viddy ;;
            "HTMLQ (Like jq, but for HTML)") install_htmlq ;;
            "SYSZ (A terminal UI for systemctl)") install_sysz ;;
            "PUEUE (A command-line task management tool)") install_pueue ;;
            "VIZEX (Visualize disk space usage)") install_vizex ;;
            "GPING (Ping, but with a graph)") install_gping ;;
            "TEMPMAIL (A temporary email right from your terminal)") install_tempmail ;;
            "BAT (A cat clone with syntax highlighting)") install_bat ;;
            "NAVI (An interactive cheatsheet tool)") install_navi ;;
            *) echo "Invalid choice: $choice" | gum style --foreground="#C0392B" --border-foreground="#C0392B" --border rounded --align center ;;
        esac
    done
fi

gum style --foreground="#239B56" --border-foreground="#239B56" --border double --align center --padding "1 2" "Installation complete."

if [ "$(getent passwd $USER | cut -d: -f7)" != "/bin/zsh" ]; then
    chsh -s /bin/zsh
fi
exec zsh -l